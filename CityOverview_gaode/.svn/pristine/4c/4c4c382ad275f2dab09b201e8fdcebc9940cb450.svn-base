<%@ page import="com.cetc28.util.Web_srcUtil" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>一站式办理</title>
    <link rel="stylesheet" href="../../myCss/bootstrap.min.css"/>
    <%--<link rel="stylesheet" type="text/css" href="../../map/arcgis_js/dijit/themes/tundra/tundra.css">--%>
    <%--<link rel="stylesheet" type="text/css" href="../../map/arcgis_js/esri/css/esri.css" />--%>
    <%--<link rel="stylesheet" type="text/css" href="../../map/arcgis_js/dojox/layout/resources/ExpandoPane.css" />--%>
    <%--<link rel="stylesheet" type="text/css" href="../../map/arcgis_js/dijit/themes/soria/soria.css" />--%>

    <style>
        html {
            padding: 0;
            margin: 0;
            width: 100%;
            height: 100%;
            box-sizing: border-box;
        }

        body {
            width: 100%;
            height: 100%;
            margin: 0;
            background-image: url('../../images/adminService/adminbg.png');
            background-size: 100% 100%;
            position: relative;
            box-sizing: border-box;
        }

        div, h2, h1, p {
            margin: 0;
        }

        li {
            list-style: none;
        }

        .floatLeft {
            /*display: inline-block;*/
            float: left;
        }

        p.headerTitle {
            padding-left: 1%;
            font-size: 20px;
            font-weight: bold;
            color: #fff;
            height: 12%;
            width: 50%;
            line-height: 35px;
            margin: 4px 4px;
        }

        div.hjxxgkl {
            height: 85%;
            width: 99%;
        }

        .header {
            width: 100%;
            height: 9%;
            position: relative;
            /*border: 1px solid red;*/
        }

        .main {
            width: 100%;
            height: 87%;
            margin-top: 1%;
            /*border: 1px solid blue;*/
        }

        #bigLogo {
            position: absolute;
        }

        #bigLogo #cetc {
            float: left;
            width: 190px;
        }

        #bigLogo #logo {
            float: left;
            /*width: 250px;*/
            width: 100%;
        }

        #bigLogo {
            /*width:510px;*/
            position: absolute;
            left: 0px;
            top: 0px;
            /*height:20px;*/
            width: 20%;
            height: 95%;
            border-left: 0.3em solid #0CDAF5;
            padding-left: 0.4em;
            margin-left: 1em;
            z-index: 66;
        }

        div#right {
            float: left;
            /*width: 250px;*/
            width: 100%;
            height: 100%;
            padding-top: 10px;
            padding-left: 10px;
        }

        .timer {
            position: absolute;
            height: 30px;
            line-height: 30px;
            /*width: 250px;*/
            width: 100%;
            background-color: #0CDAF5;
            color: #02282D;
            margin-top: 1em;
            padding-left: 10px;
            top: 35px;
            z-index: 77;
            font-size: 1.2em;
        }

        .title {
            width: 20%;
            color: #0CDAF5;
            padding: 0.2em 1em;
            font-size: 2.4em;
            font-weight: bold;
            position: absolute;
            text-align: center;
            left: 40%;
            top: 55%;
            z-index: 200;

            /*background-image: url(../../images/publicServe/zdpyc.png);background-size: 100%,100%;background-repeat: no-repeat;*/
        }

        /*主体内容*/
        .main > .mainLeft, .main > .mainRight {
            width: 25%;
            height: 100%;
        }

        .main > .mainLeft > div, .main > .mainRight > div {
            width: 96%;
            height: 32.5%;
            margin-top: 2%;
            margin-left: 2%;
            margin-right: 2%;
            background-color: rgba(23, 33, 34, 0.6);
            border-top: 2px #0CDAF5 solid;
            border-bottom: 1px #12363A solid;
        }

        .main > .mainMiddle {
            width: 50%;
            height: 100%;
            margin-top: 0.6%;
        }

        .main > .mainMiddle > .mainMiddle-top {
            width: 98%;
            height: 66%;
            margin-left: 1%;
            position: relative;
            background: url("../../images/adminService/mapbg.png") no-repeat;
            background-size: 100% 100%;
        }

        .main > .mainMiddle > .mainMiddle-bottom {
            width: 98%;
            height: 32%;
            margin: 1% 0 0 1%;
            background-color: rgba(23, 33, 34, 0.6);
            border-top: 2px #0CDAF5 solid;
            border-bottom: 1px #12363A solid;
        }

        /*地图信息*/
        #map {
            position: absolute;
            top: 21%;
            left: 23%;
            width: 60%;
            height: 67%;
        }

        #bj {
            position: absolute;
            left: 7%;
            top: 14%;
            z-index: 800;
        }

        #bjCount {

            font-size: 20px;
            color: #b6b6b6;
            text-align: center;

        }

        #bj span {
            color: #0CD8F3;
            font-size: 30px;
            font-weight: bold;
        }

        #bjPercent {
            font-size: 20px;
            color: #b6b6b6;
            text-align: center;
        }

        /*多图联审*/
        .dtls {
            position: relative;
        }

        .dtls > .dtls-a {
            width: 100%;
            height: 100%;
            padding-left: 7%;
            padding-top: 2%;
        }

        .dtls > .dtls-b {
            width: 32%;
            height: 40%;
            text-align: center;
            position: absolute;
            top: 34%;
            left: 36.5%;
        }

        .dtls > .dtls-b > p {
            color: #49A3E9;
            font-size: 1em;
            line-height: 2em;
            font-weight: bold;
        }

        .dtls > .dtls-b > p > span {
            font-size: 1.6em;
        }

        .dtls > .dtls-a > div {
            width: 40%;
            height: 35%;
            color: #0CDAF5;
            font-size: 1.3em;
            margin: 2% 4%;
            padding: 0.3em 0.5em;
            display: inline-block;
        }

        .dtls > .dtls-a > div > p {
            line-height: 1.4em;
            text-align: center;
        }

        .dtls > .dtls-a > div > p > span {
            color: #0CDAF5;
            font-size: 1.5em;
        }

        .dtls-a-1 {
            background-image: url('../../images/adminService/topLeft.png');
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }

        .dtls-a-2 {
            background-image: url('../../images/adminService/topRight.png');
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }

        .dtls-a-3 {
            background-image: url('../../images/adminService/bottomLeft.png');
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }

        .dtls-a-4 {
            background-image: url('../../images/adminService/bottomRight.png');
            background-repeat: no-repeat;
            background-size: 100% 100%;
        }

        /*平台性能*/
        #ptxn {
            padding-left: 12%;
            padding-top: 3%;
            box-sizing: border-box;
        }

        #ptxn p {
            font-weight: bold;
        }

        #ptxn > div {
            width: 36%;
            height: 36%;
            color: #fff;
            font-size: 1.2em;
            text-align: center;
            margin: 2% 5%;
            padding: 0.2em 0.5em;
            display: inline-block;
        }

        #ptxn > div > h2 {
            /*float: left;*/
            color: #3F72AC;
            font-size: 1.5em;
            margin-top: 10%;

        }

        .ptxn-2 h2 {
            background: url("../../images/onlineDetails-jt2.png") no-repeat 85% center;
            background-size: 10%;
            /*height: 100%;*/
        }

        /*不动产*/
        /*#bdc>table{*/
        /*width: 100%;*/
        /*height: 95%;*/
        /*color: #b6b6b6;*/
        /*font-size: larger;*/
        /*text-align: center;*/
        /*margin-top: 5%;*/
        /*}*/
        /*#bdc>table th{*/
        /*text-align: center;*/
        /*}*/
        /*thead tr{*/
        /*height: 35px;*/
        /*}*/

        .titletd td {
            background-color: #191919;
            padding: 2px;
            text-align: center;
            color: #fff
        }

        .datatd td {
            background-color: #191919;
            height: 25px;
            text-align: center;
            color: #fff
        }

        .titletd td, .datatd tr:nth-of-type(even) td {
            background-color: #303030;
        }

        .td1 {
            width: 110px;
        }

        .td2 {
            width: 110px;
        }

        .td3 {
            width: 110px;
        }

        .td4 {
            width: 110px;
        }

        /*.td5{width:40px;}*/
        /*.td6{width:40px;}*/
        /*.td7{width:60px;}*/ /*政务信息资源共享交换平台*/
        #jhpt {
            padding-top: 3%;
            box-sizing: border-box;
            /*background-image: url("../../images/adminService/jhpt.png");*/
            /*background-repeat: no-repeat;*/
            /*background-size: 80% 85%;*/
            /*background-position: 40% 40%;*/
        }

        #jhpt > div {
            width: 96%;
            height: 18%;
            margin: 0 0 0 2%;
            vertical-align: middle;
        }

        #jhpt > p {
            width: 96%;
            height: 19%;
            margin: 0 0 0 7%;
            vertical-align: middle;
        }

        #jhpt > div > img {
            width: 2%;
            height: 63%;
            margin-left: 49%;
        }

        #jhpt > p > span {
            color: #0CD6F1;
            font-size: 1.2em;
            display: inline-block;
            text-align: center;
            vertical-align: middle;
            background-color: #1E3044;
            border-radius: 5px;
        }

        #jhpt > .jhpt-1 > span {
            margin-left: 7%;
            margin-right: 12%;
            padding: 0.5% 2%;
        }

        #jhpt > .jhpt-3 > span {

            color: #448FE3;
            margin-left: 33%;
            padding: 0.5% 2%;
            background-color: #1E3044;
            border-radius: 5px;
        }

        #jhpt > .jhpt-5 > span {
            margin-left: 6.6%;
            padding: 0.5% 2%;
        }

        #jhpt > .jhpt-1:first-child {
            margin-left: 6.5%;
        }

        /*数据流*/
        #sjl {
            width: 100%;
            height: 88%;
            box-sizing: border-box;
            padding: 6% 0 0 16%;
        }

        #sjl > img {
            width: 80%;
            height: 70%;
        }

        #mapBG_zoom_slider {
            display: none;
        }

        #bjl {
            position: absolute;
            bottom: 25px;
            left: 25px;
            z-index: 555;
            color: #fff;
        }

        .marker-xxqy-name span {
            white-space: nowrap;
            font-size: 24px;
            color: #fff;
            font-weight: bolder;
        }
        .amap-info-content{
            border-radius: 6px;
            font-weight: bolder;
            font-family: "Microsoft YaHei";
        }
    </style>

    <script>
        var qhbh = '<%=Web_srcUtil.getString("qybh")%>';
        var cityId = '<%=Web_srcUtil.getString("cityId")%>';
        var mapHost = '<%=Web_srcUtil.getString("mapHost")%>';
        var mapPort = '<%=Web_srcUtil.getString("mapPort")%>';
        var arcgisServiceUrl = '<%=Web_srcUtil.getString("arcgisServiceUrl")%>';
        var jiaxingJtSslkServiceUrl = '<%=Web_srcUtil.getString("jiaxingJtSslkServiceUrl")%>';
        var mapServiceTpye = '<%=Web_srcUtil.getString("mapServiceTpye")%>';
        var xmin = 120.302546;
        var ymin = 30.25204;
        var xmax = 121.547912;
        var ymax = 31.036507;
        var hostUrl = mapHost + ":" + mapPort + "/CityOverview/map";
        var url = location.search;

        if (url.indexOf("?") != -1) {
            var str = url.substr(1);
            var strs = new Array();
            strs = str.split('&');
//      model = strs[0].slice(strs[0].indexOf("=")+1);
            mainWin = strs[0].slice(strs[0].indexOf("=") + 1);
        }
        function returnMainPage() {
            location.href = "http://" + mapHost + ":" + mapPort + "/CityOverview/main.jsp?bh=" + mainWin;
        }
    </script>
</head>

<body>

<%--返回上一页--%>
<a href="javascript:void(0);" onclick="returnMainPage()"
   style="max-width:3%;position: fixed;left:97%;top: 2%;z-index: 1000"><img src="../../images/returnUp.png" alt=""></a>
<!-- 头部logo主题 -->
<div class="header">
    <div id="bigLogo">
        <%--<img src="../../images/cetc.png" alt="" id="cetc"/>--%>
        <div id="right">
            <img src="../../images/logo.png" alt="" id="logo"/>
            <div class="timer">
            </div>
        </div>
    </div>
    <h1 class="title">"数据跑腿 一网运行"</h1>
</div>


<!-- 页面主体部分 -->
<div class="main">


    <!-- 左侧三个模块 -->
    <div class="mainLeft floatLeft">

        <!-- 企业投资项目 -->
        <div class="mainLeft-top">
            <p class="headerTitle">企业投资项目</p>
            <div class="hjxxgkl" id="qytz">
            </div>
        </div>

        <!-- 多图联审 -->
        <div class="mainLeft-middle">
            <p class="headerTitle">多图联审</p>
            <div class="hjxxgkl dtls">
                <div class="dtls-a">
                    <div class="dtls-a-1">
                        <p>二期标准厂房<br><span>5</span>天</p>
                    </div>
                    <div class="dtls-a-2">
                        <p>汽车零配件<br><span>4</span>天</p>
                    </div>
                    <div class="dtls-a-3">
                        <p>新型材料技改<br><span>6</span>天</p>
                    </div>
                    <div class="dtls-a-4">
                        <p>PTC热器组件<br><span>5</span>天</p>
                    </div>
                </div>
                <div class="dtls-b">
                    <p>平均用时<br><span>5</span>天</p>
                </div>
            </div>
        </div>

        <!-- 平台性能 -->
        <div class="mainLeft-bottom">
            <p class="headerTitle">平台性能</p>
            <div class="hjxxgkl" id="ptxn">
                <div class="ptxn-1">
                    <p>月交换数据量</p>
                    <h2><span class="counter">136902</span></h2>
                </div>
                <div class="ptxn-2">
                    <p>月交换数据环比</p>
                    <h2><span class="counter">120</span>%</h2>
                </div>
                <div class="ptxn-3">
                    <p>平均交换时长</p>
                    <h2><span class="counter">0.63</span>s</h2>
                </div>
                <div class="ptxn-4">
                    <p>上传下载比</p>
                    <h2><span class="counter">0.98</span>%</h2>
                </div>
            </div>
        </div>
    </div>


    <!-- 中间三个模块 -->
    <div class="mainMiddle floatLeft">
        <div class="mainMiddle-top" id="mapBG">
            <%--<img src="../../images/onlineDetails-map.png" alt="" id="map"/>--%>
            <div id="bj">
                <p id="bjCount">当年累计办件量<br><span>32,498</span></p>
                <p id="bjPercent">同比增长<br><span>22.5%</span></p>
            </div>
            <div id="bjl">
                <h5>办件量：件</h5>
                <div>

                </div>
            </div>
        </div>

        <div class="mainMiddle-bottom" id="jhpt">
            <p class="jhpt-1">
                <span>不动产登记</span>
                <span>投资项目</span>
                <span>商事登记</span>
            </p>
            <div class="jhpt-2"><img src="../../images/adminService/onlineDetails-jt.png" alt=""></div>
            <p class="jhpt-3"><span>政务信息资源共享交换平台</span></p>
            <div class="jhpt-4"><img src="../../images/adminService/onlineDetails-jt.png" alt=""></div>
            <p class="jhpt-5">
                <span>市场监管</span>
                <span>国土</span>
                <span>公积金</span>
                <span>社保</span>
                <span>政府单位</span>
            </p>
        </div>
    </div>


    <!-- 右侧三个模块 -->
    <div class="mainRight floatLeft">
        <!-- 不动产登记 -->
        <div class="mainRight-top">
            <p class="headerTitle headerTitle3">不动产登记</p>
            <div id="bdc" style="width: 95%;height: 75%;overflow: hidden">
                <table border="0" width="100%" cellspacing="0" cellpadding="0">
                    <tr>
                        <td width="100%">
                            <table width="440px" border="0" cellpadding="0" cellspacing="1">
                                <tr class="titletd">
                                    <td nowrap class="td1">受理号</td>
                                    <td nowrap class="td2">受理时间</td>
                                    <td nowrap class="td3">办结时间</td>
                                    <td nowrap class="td4">时长</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td width="100%">
                            <div id="A1">
                                <div id="A2">
                                    <table width="440px" border="0" cellpadding="0" cellspacing="1"
                                           style="margin-top:-1px;">
                                        <tbody class="datatd">
                                        <tr>
                                            <td nowrap class="td1">1</td>
                                            <td nowrap class="td2">16:55</td>
                                            <td nowrap class="td3">17:15</td>
                                            <td nowrap class="td4">20</td>
                                        </tr>
                                        <tr>
                                            <td nowrap class="td1">2</td>
                                            <td nowrap class="td2">16:55</td>
                                            <td nowrap class="td3">17:15</td>
                                            <td nowrap class="td4">20</td>
                                        </tr>
                                        <tr>
                                            <td nowrap class="td1">3</td>
                                            <td nowrap class="td2">16:55</td>
                                            <td nowrap class="td3">17:15</td>
                                            <td nowrap class="td4">20</td>
                                        </tr>
                                        <tr>
                                            <td nowrap class="td1">4</td>
                                            <td nowrap class="td2">16:55</td>
                                            <td nowrap class="td3">17:15</td>
                                            <td nowrap class="td4">20</td>
                                        </tr>
                                        <tr>
                                            <td nowrap class="td1">5</td>
                                            <td nowrap class="td2">16:55</td>
                                            <td nowrap class="td3">17:15</td>
                                            <td nowrap class="td4">20</td>
                                        </tr>
                                        <tr>
                                            <td nowrap class="td1">6</td>
                                            <td nowrap class="td2">16:55</td>
                                            <td nowrap class="td3">17:15</td>
                                            <td nowrap class="td4">20</td>
                                        </tr>
                                        <tr>
                                            <td nowrap class="td1">7</td>
                                            <td nowrap class="td2">16:55</td>
                                            <td nowrap class="td3">17:15</td>
                                            <td nowrap class="td4">20</td>
                                        </tr>
                                        <tr>
                                            <td nowrap class="td1">8</td>
                                            <td nowrap class="td2">16:55</td>
                                            <td nowrap class="td3">17:15</td>
                                            <td nowrap class="td4">20</td>
                                        </tr>
                                        <tr>
                                            <td nowrap class="td1">9</td>
                                            <td nowrap class="td2">16:55</td>
                                            <td nowrap class="td3">17:15</td>
                                            <td nowrap class="td4">20</td>
                                        </tr>
                                        <tr>
                                            <td nowrap class="td1">10</td>
                                            <td nowrap class="td2">16:55</td>
                                            <td nowrap class="td3">17:15</td>
                                            <td nowrap class="td4">20</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- 数据流 -->
        <div class="mainRight-middle">
            <p class="headerTitle headerTitle2">数据流</p>
            <div id="sjl">
                <img src="../../images/adminService/onlineDetails-sjl.png" alt="">
            </div>
        </div>

        <!-- 办件趋势 -->
        <div class="mainRight-bottom">
            <p class="headerTitle headerTitle2">办件趋势</p>
            <div class="hjxxgkl" id="bjqs" style="width: 94%;height: 88%;margin-left: 3%;"></div>
        </div>
    </div>
</div>
<script src="../../map/js/jquery-1.11.3.js"></script>
<script src="../../myjs/echarts-all.js"></script>
<%--<script type="text/javascript" src="../../map/arcgis_js/init.js"></script>--%>
<%--<script type="text/javascript" src="../../map/arcgis_js/dojo/dojo.js" diConfig="parseOnLoad:true" ></script>--%>
<script type="text/javascript" src="../../myjs/loadMapService2.js"></script>
<script src="../../myjs/myEcharts.js"></script>
<script src="../../map/js/jquery.waypoints.min.js"></script>
<script src="../../map/js/jquery.countup.js"></script>
<script type="text/javascript" src='//webapi.amap.com/maps?v=1.4.1&key=608d75903d29ad471362f8c58c550daf'></script>
<!-- UI组件库 1.0 -->
<script src="//webapi.amap.com/ui/1.0/main.js?v=1.0.11"></script>
<script>    //  console.log($(".hjxxgkl").length);
function _InitScroll(_S1, _S2, _W, _H, _T) {
    return "var marqueesHeight" + _S1 + "=" + _H + ";var stopscroll" + _S1 + "=false;var scrollElem" + _S1 + "=document.getElementById('" + _S1 + "');with(scrollElem" + _S1 + "){style.width=" + _W + ";style.height=marqueesHeight" + _S1 + ";style.overflow='hidden';noWrap=true;}scrollElem" + _S1 + ".onmouseover=new Function('stopscroll" + _S1 + "=true');scrollElem" + _S1 + ".onmouseout=new Function('stopscroll" + _S1 + "=false');var preTop" + _S1 + "=0; var currentTop" + _S1 + "=0; var stoptime" + _S1 + "=0;var leftElem" + _S2 + "=document.getElementById('" + _S2 + "');scrollElem" + _S1 + ".appendChild(leftElem" + _S2 + ".cloneNode(true));setTimeout('init_srolltext" + _S1 + "()'," + _T + ");function init_srolltext" + _S1 + "(){scrollElem" + _S1 + ".scrollTop=0;setInterval('scrollUp" + _S1 + "()',50);}function scrollUp" + _S1 + "(){if(stopscroll" + _S1 + "){return;}currentTop" + _S1 + "+=1;if(currentTop" + _S1 + "==(marqueesHeight" + _S1 + "+1)) {stoptime" + _S1 + "+=1;currentTop" + _S1 + "-=1;if(stoptime" + _S1 + "==" + _T / 50 + ") {currentTop" + _S1 + "=0;stoptime" + _S1 + "=0;}}else{preTop" + _S1 + "=scrollElem" + _S1 + ".scrollTop;scrollElem" + _S1 + ".scrollTop +=1;if(preTop" + _S1 + "==scrollElem" + _S1 + ".scrollTop){scrollElem" + _S1 + ".scrollTop=0;scrollElem" + _S1 + ".scrollTop +=1;}}}";
}

eval(_InitScroll("A1", "A2", 440, 26 * 8, 1000));
function qytz() {
    var myChart1 = echarts.init(document.getElementById("qytz"));
    var option1 = {
        color: ['#5A9DDB'],
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow'
            }
        },
        calculable: false,
        legend: {
            data: ['办件量'],
            show: false
        },
        grid: {
            x: '15%',
            y: '20%',
            x2: '5%',
            y2: '15%',
            containLabel: true,
            borderWidth: 0
        },
        xAxis: [
            {
                type: 'category',
                splitLine: {show: false},
                axisLine: {show: true, lineStyle: {color: '#B6B6B6'}},
                axisTick: {show: false},
                axisLabel: {show: true, textStyle: text_style},
                data: ['发改', '经信', '国土', '规划', '环保', '建设', '人防']
            }
        ],
        yAxis: [
            {
                type: 'value',
                name: '办件量（件）',
                nameTextStyle: text_style,
                splitLine: {show: true, lineStyle: {type: 'dashed', color: '#2D2D2D'}},
                axisLine: {show: true, lineStyle: {color: '#B6B6B6'}},
                axisTick: {show: false},
                axisLabel: {show: true, textStyle: text_style}
            }
        ],
        series: [
            {
                name: '办件量',
                type: 'bar',
                barWidth: 20,
//          barGap: '0',
                barCategoryGap: '40%',
//					itemStyle:{
//						normal: {
//							label: {
//								show: true,
//								textStyle: text_style
//							}
//						}
//					},
                data: [4300, 2500, 3500, 4500, 5000, 7000, 6000]
            }
        ]
    };
    myChart1.setOption(option1);
}
function bjqs() {
    var myChart2 = echarts.init(document.getElementById("bjqs"));
    var option2 = {
        color: ['#C3AA45'],
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow'
            }
        },
        calculable: false,
        legend: {
            data: ['办件量'],
            show: false
        },
        grid: {
            x: '12%',
            y: '15%',
            x2: '5%',
            y2: '25%',
            containLabel: true,
            borderWidth: 0
        },
        xAxis: [
            {
                type: 'category',
                splitLine: {show: false},
                axisLine: {show: true, lineStyle: {color: '#B6B6B6'}},
                axisTick: {show: false},
                axisLabel: {show: true, textStyle: text_style},
                data: ['一月', '二月', '三月', '四月', '五月', '六月', '七月']
            }
        ],
        yAxis: [
            {
                type: 'value',
                name: '办件量（件）',
                nameTextStyle: text_style,
                splitLine: {show: true, lineStyle: {type: 'dashed', color: '#2D2D2D'}},
                axisLine: {show: true, lineStyle: {color: '#B6B6B6'}},
                axisTick: {show: false},
                axisLabel: {show: true, textStyle: text_style}
            }
        ],
        series: [
            {
                name: '办件量',
                type: 'bar',
                barWidth: 20,
//          barGap: '0',
                barCategoryGap: '40%',
//					itemStyle:{
//						normal: {
//							label: {
//								show: true,
//								textStyle: text_style
//							}
//						}
//					},
                data: [4300, 2500, 3500, 4500, 5000, 7000, 6000]
            }
        ]
    };
    myChart2.setOption(option2);
}
qytz();
bjqs();
</script>

<script>
    $(function () {
//		数字动态效果
        $('.counter').countUp({
            delay: 2,
            time: 200
        });
//地图功能开始
        var map, wxdlayer, featureLayer;

        function init() {
            require([
                "esri/map",
                "esri/layers/ArcGISDynamicMapServiceLayer", "esri/layers/WMSLayer", "esri/layers/WMTSLayer", "esri/layers/TileInfo", "esri/SpatialReference",
                "esri/layers/ImageParameters", "esri/layers/WMTSLayerInfo", "tdlib/TDTLayer", "esri/geometry/Extent",
                "tdlib/TDTAnnoLayer", "tdlib/TDTRLayer", "esri/layers/ArcGISTiledMapServiceLayer", "esri/layers/GraphicsLayer", "dojo/domReady!"
            ], function (Map, ArcGISDynamicMapServiceLayer, WMSLayer, WMTSLayer, TileInfo, SpatialReference, ImageParameters, WMTSLayerInfo, TDTLayer, Extent,
                         TDTAnnoLayer, TDTRLayer, ArcGISTiledMapServiceLayer, GraphicsLayer) {
                var bounds = new Extent({
                    "xmin": xmin, "ymin": ymin, "xmax": xmax, "ymax": ymax,
                    "spatialReference": {"wkid": 4490}
                });
                map = new Map("mapBG", {
                    extent: bounds,
                    logo: false,
                    showLabels: true,
                    zoom: 10
                });
//				var dlayer=new ArcGISTiledMapServiceLayer("http://192.168.120.215:6080/arcgis/rest/services/testmap01/MapServer",{opacity:1});
                wxdlayer = loadMapService(arcgisServiceUrl, "000002", {opacity: 1});
                map.addLayer(wxdlayer);

                featureLayer = loadMapService(arcgisServiceUrl, "000003", {
                    opacity: 0.3,
                    mode: esri.layers.FeatureLayer.MODE_SNAPSHOT,
                    outFields: ["*"]
                });
                map.addLayer(featureLayer);

                $.ajax({
                    url: '../../jxaddmin/queryYearAreaItems.do',
                    type: 'POST',
                    dataType: 'json',
                    success: function (data) {
                        console.log(data)
                        var arr = [];
                        var len = data.length;
                        var detailsArr = [];
                        var color = ["(230,98,98,0.5)", "(226,230,98,0.5)", "(105,185,231,0.5)", "(101,211,127,0.5)", "(221,105,231,0.5)"]
                        var color0 = ["(230,98,98)", "(226,230,98)", "(105,185,231)", "(101,211,127)", "(221,105,231)"]//图例原色
                        for (var i = 0; i < len; i++) {
                            arr.push(data[i].sumnum);
                        }
                        var max = Math.max.apply([], arr);
                        var min = Math.min.apply([], arr);
                        var lev = Math.ceil((max - min) / 5);
                        var p = "";
                        //编写图例
                        var Array = [];//存放图例范围值，地图渲染时做对比使用，根据不同范围设置不同的渲染颜色
                        for (var n = 0; n < 5; n++) {
                            if (n >= 1) {
                                p += "<p style='margin:10px 0px;'><span style='margin-right:15px;vertical-align: middle;display:inline-block;width:20px;height:20px;background-color:rgb" + color0[n] + "'></span>"
                                        + (min + lev * n + 1) + "-" + (min + lev * (n + 1)) + "</p>"
                                Array.push([(min + lev * n + 1), (min + lev * (n + 1)), "rgba" + color[n]])
                            } else {
                                p += "<p style='margin:10px 0px;'><span style='margin-right:15px;vertical-align: middle;display:inline-block;width:20px;height:20px;background-color:rgb" + color0[n] + "'></span>"
                                        + (min + lev * n) + "-" + (min + lev * (n + 1)) + "</p>"
                                Array.push([(min + lev * n), (min + lev * (n + 1)), "rgba" + color[n]])
                            }
                            $("#bjl div").append(p);
                        }
                        $("#bjl div").html(p);
                        //处理地图图层中使用的数据
                        for (var j = 0; j < len; j++) {
                            var obj = {};
                            obj.qy = data[j].qhmc;
                            obj.value = data[j].sumnum;
                            if (data[j].sumnum >= Array[0][0] && data[j].sumnum <= Array[0][1]) {
                                obj.color = Array[0][2];
                            }
                            if (data[j].sumnum >= Array[1][0] && data[j].sumnum <= Array[1][1]) {
                                obj.color = Array[1][2];
                            }
                            if (data[j].sumnum >= Array[2][0] && data[j].sumnum <= Array[2][1]) {
                                obj.color = Array[2][2];
                            }
                            if (data[j].sumnum >= Array[3][0] && data[j].sumnum <= Array[3][1]) {
                                obj.color = Array[3][2];
                            }
                            if (data[j].sumnum >= Array[4][0] && data[j].sumnum <= Array[4][1]) {
                                obj.color = Array[4][2];
                            }
                            detailsArr.push(obj);
                        }
                        drawMap(detailsArr, 999)
                    }
                });
                function drawMap(data, title) {
                    var defaultSymbol = new esri.symbol.SimpleFillSymbol();
                    defaultSymbol.setStyle(new esri.symbol.SimpleFillSymbol().STYLE_NULL);
                    defaultSymbol.outline.setStyle(new esri.symbol.SimpleFillSymbol().STYLE_NULL);
                    var featureLayers = [];
                    // 创建渲染器
                    var renderer = new esri.renderer.UniqueValueRenderer(defaultSymbol, "LAST_NAME9");
                    featureLayer.on("click", function (evt) {
                        map.infoWindow.setTitle(title);
                        map.infoWindow.resize(200, 200);
                        for (var i = 0; i < data.length; i++) {
                            if (data[i].qy == evt.graphic.attributes.LAST_NAME9) {
                                map.infoWindow.setContent(
                                        '<div>' + "累计办件量：" + evt.graphic.attributes.LAST_NAME9 + data[i].value + '件</div>'
                                );
                            }
                        }
                        map.infoWindow.show(evt.mapPoint, map.getInfoWindowAnchor(evt.screenPoint));
                    })
                    for (var i = 0; i < data.length; i++) {
                        renderer.addValue(data[i].qy, esri.symbol.SimpleFillSymbol().setColor(data[i].color));
                        featureLayer.opacity = 0.8;
                        featureLayers.push(featureLayer);
                        featureLayer.setRenderer(renderer);
                        map.addLayer(featureLayer);
                    }
                }

            });
        }

//		dojo.addOnLoad(init);


        //左上角日期
        var timer = {
            date: "",
            timeAjax: function () {
                var me = this;
                $.ajax({
                    url: '../../jxsys/getCurrentTime.do',
                    type: 'POST',
                    dataType: 'json',
                    success: function (date) {
                        me.date = date;
                        me.showCurDate();
                    }
                });
                return this
            },
            showCurDate: function () {
                var me = this;

                function changeNumber(num) {
                    if (num < 10) {
                        return '0' + num;
                    } else {
                        return '' + num;
                    }
                }

                setInterval(function () {
                    var T = new Date(me.date)
                    newDate = changeNumber(T.getFullYear()) + "年" +
                            changeNumber((parseInt(T.getMonth()) + 1)) + "月" +
                            changeNumber(T.getDate()) + "日  " +
                            changeNumber(T.getHours()) + ":" +
                            changeNumber(T.getMinutes()) + ":" +
                            changeNumber(T.getSeconds()) + ""
                    me.date += 1000;
                    $(".timer").html(newDate)
                }, 1000)
                return this
            }
        }
        timer.timeAjax();
    })

    $.ajax({
        url: '../../jxaddmin/queryYearAllItems.do',
        type: 'POST',
        dataType: 'json',
        success: function (data) {
            $("#bjCount span").html(data)
        }
    });

    //定义高德地图
    var map = new AMap.Map('mapBG', {
        cursor: 'default',
        mapStyle: 'amap://styles/dark',//样式URL
        zoom: 10
    });
    map.panTo([120.752, 30.692]);//默认第一个参数的坐标点居中

    var colors = [
        "#412929", "#402B41", "#414129", "#2B3941", "#413729", "#2A3E2F", "#2B2C41", "#66aa00",
        "#b82e2e", "#316395", "#994499", "#22aa99", "#aaaa11", "#000000", "#000000", "#000000",
        "#000000", "#000000", "#000000", "#000000"
    ];

    var point = [
        {name: '平湖市', po: '121.114666, 30.698921'},
        {name: '海盐县', po: '120.942017, 30.522223'},
        {name: '南湖区', po: '120.829953, 30.734652'},
        {name: '嘉善县', po: '120.921871, 30.891352'},
        {name: '秀洲区', po: '120.680431, 30.803323'},
        {name: '海宁市', po: '120.688821, 30.475544'},
        {name: '桐乡市', po: '120.521085, 30.629065'}
    ];
    var markers = [];
    for (var i = 0; i < point.length; i++) {
        markers[i] = new AMap.Marker({ //添加自定义点标记
            map: map,
            position: point[i].po.split(','), //基点位置
            offset: new AMap.Pixel(-36, -15), //相对于基点的偏移位置
            draggable: false,  //是否可拖动
            content: '<div class="marker-xxqy-name"><span>' + point[i].name + '</span></div>'   //自定义点标记覆盖物内容
        });
    }


    AMapUI.loadUI(['geo/DistrictExplorer'], function (DistrictExplorer) {

        var color = ["(230,98,98,0.5)", "(226,230,98,0.5)", "(105,185,231,0.5)", "(101,211,127,0.5)", "(221,105,231,0.5)"]
        var color0 = ["(230,98,98)", "(226,230,98)", "(105,185,231)", "(101,211,127)", "(221,105,231)"]//图例原色
        var detailsArr = [];//图层数据
        var adcodes = [330400];
        $.ajax({
            url: '../../jxaddmin/queryYearAreaItems.do',
            type: 'POST',
            dataType: 'json',
            success: function (data) {
                var arr = [];
                var len = data.length;
                for (var i = 0; i < len; i++) {
                    arr.push(data[i].sumnum);
                }
                var max = Math.max.apply([], arr);
                var min = Math.min.apply([], arr);
                var lev = Math.ceil((max - min) / 5);
                var p = "";
                //编写图例
                var Array = [];//存放图例范围值，地图渲染时做对比使用，根据不同范围设置不同的渲染颜色
                for (var n = 0; n < 5; n++) {
                    if (n >= 1) {
                        p += "<p style='margin:10px 0px;'><span style='margin-right:15px;vertical-align: middle;display:inline-block;width:20px;height:20px;background-color:rgb" + color0[n] + "'></span>"
                                + (min + lev * n + 1) + "-" + (min + lev * (n + 1)) + "</p>"
                        Array.push([(min + lev * n + 1), (min + lev * (n + 1)), "rgba" + color[n]])
                    } else {
                        p += "<p style='margin:10px 0px;'><span style='margin-right:15px;vertical-align: middle;display:inline-block;width:20px;height:20px;background-color:rgb" + color0[n] + "'></span>"
                                + (min + lev * n) + "-" + (min + lev * (n + 1)) + "</p>"
                        Array.push([(min + lev * n), (min + lev * (n + 1)), "rgba" + color[n]])
                    }
                }
                $("#bjl div").html(p);
                //处理地图图层中使用的数据
                for (var j = 0; j < len; j++) {
                    var obj = {};
                    obj.qy = data[j].qhmc;
                    obj.value = data[j].sumnum;
                    if (data[j].sumnum >= Array[0][0] && data[j].sumnum <= Array[0][1]) {
                        obj.color = Array[0][2];
                    }
                    if (data[j].sumnum >= Array[1][0] && data[j].sumnum <= Array[1][1]) {
                        obj.color = Array[1][2];
                    }
                    if (data[j].sumnum >= Array[2][0] && data[j].sumnum <= Array[2][1]) {
                        obj.color = Array[2][2];
                    }
                    if (data[j].sumnum >= Array[3][0] && data[j].sumnum <= Array[3][1]) {
                        obj.color = Array[3][2];
                    }
                    if (data[j].sumnum >= Array[4][0] && data[j].sumnum <= Array[4][1]) {
                        obj.color = Array[4][2];
                    }
                    detailsArr.push(obj);
                }
                console.log(detailsArr)
                loadMap(adcodes);//渲染图层
            }
        });

        //创建一个实例
        var districtExplorer = new DistrictExplorer({
            eventSupport: true, //打开事件支持
            map: map
        });

        function renderAreaNode(areaNode) {

            //绘制子区域
            districtExplorer.renderSubFeatures(areaNode, function (feature, i) {
                feature.content = getAreaData(feature.properties.name);
                var fillColor = feature.content.color;
                var strokeColor = '#000000';

                return {
                    cursor: 'default',
                    bubble: true,
                    strokeColor: strokeColor, //线颜色
                    strokeOpacity: 1, //线透明度
                    strokeWeight: 1, //线宽
                    fillColor: fillColor, //填充色
                    fillOpacity: 1 //填充透明度
                };
            });

            //绘制父区域
            districtExplorer.renderParentFeature(areaNode, {
                cursor: 'default',
                bubble: true,
                strokeColor: 'black', //线颜色
                strokeOpacity: 1, //线透明度
                strokeWeight: 1, //线宽
                fillColor: null, //填充色
                fillOpacity: 1//填充透明度
            });
        }

        function loadMap(adcodes) {
            districtExplorer.loadMultiAreaNodes(adcodes, function (error, areaNodes) {

                //清除已有的绘制内容
                districtExplorer.clearFeaturePolygons();


                for (var i = 0, len = areaNodes.length; i < len; i++) {
                    renderAreaNode(areaNodes[i]);
                }
            });
        }

        //feature被点击
        districtExplorer.on('featureClick', function (e, feature) {
            openInfo(feature.content.qy,feature.content.value,e.originalEvent.lnglat);//打开信息窗体
        });

        //获得地区数据函数
        function getAreaData(name) {
            var result = {};
            $.each(detailsArr, function (i, v) {
                if (v.qy == name) {
                    result = v;
                }
            })
            return result;
        }

    });


    function openInfo(areaName,num,pos) {
        //构建信息窗体中显示的内容
        var info = [];
        info.push("<div>累计办件量：" + areaName + num + "件</div></div>");
        infoWindow = new AMap.InfoWindow({
            content: info.join("<br/>")  //使用默认信息窗体框样式，显示信息内容
        });
        infoWindow.open(map, pos);
        map.panTo(pos);
    }
</script>
</body>
</html>
